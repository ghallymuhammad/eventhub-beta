exports.id=92,exports.ids=[92],exports.modules={84921:()=>{},37721:()=>{},74053:(e,t)=>{"use strict";t.y=void 0,t.y=function(e){return{createUser:t=>e.user.create({data:t}),getUser:t=>e.user.findUnique({where:{id:t}}),getUserByEmail:t=>e.user.findUnique({where:{email:t}}),async getUserByAccount(t){var r;let s=await e.account.findUnique({where:{provider_providerAccountId:t},select:{user:!0}});return null!==(r=null==s?void 0:s.user)&&void 0!==r?r:null},updateUser:({id:t,...r})=>e.user.update({where:{id:t},data:r}),deleteUser:t=>e.user.delete({where:{id:t}}),linkAccount:t=>e.account.create({data:t}),unlinkAccount:t=>e.account.delete({where:{provider_providerAccountId:t}}),async getSessionAndUser(t){let r=await e.session.findUnique({where:{sessionToken:t},include:{user:!0}});if(!r)return null;let{user:s,...n}=r;return{user:s,session:n}},createSession:t=>e.session.create({data:t}),updateSession:t=>e.session.update({where:{sessionToken:t.sessionToken},data:t}),deleteSession:t=>e.session.delete({where:{sessionToken:t}}),async createVerificationToken(t){let r=await e.verificationToken.create({data:t});return r.id&&delete r.id,r},async useVerificationToken(t){try{let r=await e.verificationToken.delete({where:{identifier_token:t}});return r.id&&delete r.id,r}catch(e){if("P2025"===e.code)return null;throw e}}}}},40653:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},44558:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s={};Object.defineProperty(t,"default",{enumerable:!0,get:function(){return a.default}});var n=r(40653);Object.keys(n).forEach(function(e){!("default"===e||"__esModule"===e||Object.prototype.hasOwnProperty.call(s,e))&&(e in t&&t[e]===n[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return n[e]}}))});var a=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=i(void 0);if(r&&r.has(e))return r.get(e);var s={__proto__:null},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&({}).hasOwnProperty.call(e,a)){var o=n?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(s,a,o):s[a]=e[a]}return s.default=e,r&&r.set(e,s),s}(r(65474));function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(i=function(e){return e?r:t})(e)}Object.keys(a).forEach(function(e){!("default"===e||"__esModule"===e||Object.prototype.hasOwnProperty.call(s,e))&&(e in t&&t[e]===a[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return a[e]}}))})},1645:(e,t)=>{"use strict";t.A=function(e){return{id:"credentials",name:"Credentials",type:"credentials",credentials:{},authorize:()=>null,options:e}}},28220:(e,t,r)=>{"use strict";r.d(t,{d:()=>u});var s=r(1625),n=r(44558),a=r(45330),i=r(68224);class o{static async getAllEvents(){return await i.z.event.findMany({include:{organizer:{select:{id:!0,name:!0,email:!0,role:!0,createdAt:!0,updatedAt:!0}},ticketTypes:!0,_count:{select:{reviews:!0}}},orderBy:{date:"asc"}})}static async getEventById(e){return await i.z.event.findUnique({where:{id:e},include:{organizer:{select:{id:!0,name:!0,email:!0,role:!0,createdAt:!0,updatedAt:!0}},ticketTypes:!0,reviews:{include:{user:{select:{name:!0}}},orderBy:{createdAt:"desc"}}}})}static async getEventsByCategory(e){return await i.z.event.findMany({where:{category:{contains:e,mode:"insensitive"}},include:{organizer:{select:{id:!0,name:!0,email:!0,role:!0,createdAt:!0,updatedAt:!0}},ticketTypes:!0},orderBy:{date:"asc"}})}static async searchEvents(e){return await i.z.event.findMany({where:{OR:[{title:{contains:e,mode:"insensitive"}},{description:{contains:e,mode:"insensitive"}},{category:{contains:e,mode:"insensitive"}},{location:{contains:e,mode:"insensitive"}}]},include:{organizer:{select:{id:!0,name:!0,email:!0,role:!0,createdAt:!0,updatedAt:!0}},ticketTypes:!0},orderBy:{date:"asc"}})}static async createEvent(e,t){return await i.z.event.create({data:{...t,organizerId:e},include:{organizer:{select:{id:!0,name:!0,email:!0,role:!0,createdAt:!0,updatedAt:!0}},ticketTypes:!0}})}static async updateEvent(e,t){return await i.z.event.update({where:{id:e},data:t,include:{organizer:{select:{id:!0,name:!0,email:!0,role:!0,createdAt:!0,updatedAt:!0}},ticketTypes:!0}})}static async deleteEvent(e){await i.z.event.delete({where:{id:e}})}static async getEventsByOrganizer(e,t){let{search:r,category:s,page:n=1,limit:a=10}=t,o={organizerId:e};r&&(o.OR=[{title:{contains:r,mode:"insensitive"}},{description:{contains:r,mode:"insensitive"}},{location:{contains:r,mode:"insensitive"}}]),s&&(o.category={contains:s,mode:"insensitive"});let[c,u]=await Promise.all([i.z.event.findMany({where:o,include:{organizer:{select:{id:!0,name:!0,email:!0,role:!0,createdAt:!0,updatedAt:!0}},ticketTypes:!0,_count:{select:{transactions:!0,reviews:!0}}},orderBy:{createdAt:"desc"},skip:(n-1)*a,take:a}),i.z.event.count({where:o})]);return{events:c,pagination:{page:n,limit:a,total:u,pages:Math.ceil(u/a)}}}static async getPublicEvents(e){let{search:t,category:r,page:s=1,limit:n=10}=e,a={};t&&(a.OR=[{title:{contains:t,mode:"insensitive"}},{description:{contains:t,mode:"insensitive"}},{location:{contains:t,mode:"insensitive"}}]),r&&(a.category={contains:r,mode:"insensitive"});let[o,c]=await Promise.all([i.z.event.findMany({where:a,include:{organizer:{select:{id:!0,name:!0,email:!0,role:!0,createdAt:!0,updatedAt:!0}},ticketTypes:!0,_count:{select:{reviews:!0}}},orderBy:{date:"asc"},skip:(s-1)*n,take:n}),i.z.event.count({where:a})]);return{events:o,pagination:{page:s,limit:n,total:c,pages:Math.ceil(c/n)}}}}var c=r(96330);class u{static async getAllEvents(e){try{let{searchParams:t}=new URL(e.url),r=t.get("organizerId"),i=t.get("search"),u=t.get("category"),l=parseInt(t.get("page")||"1"),d=parseInt(t.get("limit")||"10");if(r){let e=await (0,n.getServerSession)(a.N);if(!e?.user)return s.NextResponse.json({success:!1,error:"Unauthorized"},{status:401});if(e.user.role!==c.UserRole.ORGANIZER||e.user.id!==r)return s.NextResponse.json({success:!1,error:"Forbidden"},{status:403});let t=await o.getEventsByOrganizer(r,{search:i,category:u,page:l,limit:d});return s.NextResponse.json({success:!0,data:t})}let p=await o.getPublicEvents({search:i,category:u,page:l,limit:d});return s.NextResponse.json({success:!0,data:p})}catch(e){return console.error("Error fetching events:",e),s.NextResponse.json({success:!1,error:"Failed to fetch events"},{status:500})}}static async getEventById(e,{params:t}){try{let{id:e}=await t,r=await o.getEventById(e);if(!r)return s.NextResponse.json({success:!1,error:"Event not found"},{status:404});return s.NextResponse.json({success:!0,data:r})}catch(e){return console.error("Error fetching event:",e),s.NextResponse.json({success:!1,error:"Failed to fetch event"},{status:500})}}static async createEvent(e){try{let t=await (0,n.getServerSession)(a.N);if(!t?.user||t.user.role!==c.UserRole.ORGANIZER)return s.NextResponse.json({success:!1,error:"Unauthorized"},{status:401});let r=await e.json(),i=await o.createEvent(t.user.id,r);return s.NextResponse.json({success:!0,data:i},{status:201})}catch(e){return console.error("Error creating event:",e),s.NextResponse.json({success:!1,error:"Failed to create event"},{status:500})}}static async updateEvent(e,{params:t}){try{let r=await (0,n.getServerSession)(a.N);if(!r?.user||r.user.role!==c.UserRole.ORGANIZER)return s.NextResponse.json({success:!1,error:"Unauthorized"},{status:401});let i=await e.json(),{id:u}=await t,l=await o.getEventById(u);if(!l||l.organizerId!==r.user.id)return s.NextResponse.json({success:!1,error:"Event not found or access denied"},{status:404});let d=await o.updateEvent(u,i);return s.NextResponse.json({success:!0,data:d})}catch(e){return console.error("Error updating event:",e),s.NextResponse.json({success:!1,error:"Failed to update event"},{status:500})}}static async deleteEvent(e,{params:t}){try{let e=await (0,n.getServerSession)(a.N);if(!e?.user||e.user.role!==c.UserRole.ORGANIZER)return s.NextResponse.json({success:!1,error:"Unauthorized"},{status:401});let{id:r}=await t,i=await o.getEventById(r);if(!i||i.organizerId!==e.user.id)return s.NextResponse.json({success:!1,error:"Event not found or access denied"},{status:404});return await o.deleteEvent(r),s.NextResponse.json({success:!0,message:"Event deleted successfully"})}catch(e){return console.error("Error deleting event:",e),s.NextResponse.json({success:!1,error:"Failed to delete event"},{status:500})}}}},45330:(e,t,r)=>{"use strict";r.d(t,{N:()=>c});var s=r(1645),n=r(74053),a=r(68224),i=r(23606),o=r.n(i);let c={adapter:(0,n.y)(a.z),providers:[(0,s.A)({name:"credentials",credentials:{email:{label:"Email",type:"email"},password:{label:"Password",type:"password"}},async authorize(e){if(!e?.email||!e?.password)return null;let t=await a.z.user.findUnique({where:{email:e.email}});return t&&await o().compare(e.password,t.password)?{id:t.id,email:t.email,name:t.name,role:t.role,profilePicture:t.profilePicture}:null}})],session:{strategy:"jwt"},callbacks:{jwt:async({token:e,user:t})=>(t&&(e.role=t.role,e.profilePicture=t.profilePicture),e),session:async({session:e,token:t})=>(t&&(e.user.id=t.sub,e.user.role=t.role,e.user.profilePicture=t.profilePicture),e)},pages:{signIn:"/auth/signin",signUp:"/auth/signup"}}},68224:(e,t,r)=>{"use strict";r.d(t,{z:()=>n});var s=r(96330);let n=globalThis.prisma??new s.PrismaClient({log:["error"]})}};